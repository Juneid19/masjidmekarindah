<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="UTF-8">
    <title>iframe tester</title>
    <link rel="stylesheet" href="https://public.codepenassets.com/css/reset-2.0.min.css">


  </head>
    
  <body>
  <!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin - Masjid Mekarindah</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --primary-green: #198754;
            --dark-green: #146c43;
            --light-green: #e8f5e9;
        }
        
        * {
            font-family: 'Poppins', sans-serif;
        }
        
        body {
            background: #f5f5f5;
        }
        
        /* ===== LOGIN PAGE ===== */
        .login-container {
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(135deg, var(--primary-green), var(--dark-green));
        }
        
        .login-box {
            background: white;
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            width: 100%;
            max-width: 400px;
        }
        
        .login-box .logo {
            font-size: 4rem;
            color: var(--primary-green);
        }
        
        /* ===== ADMIN PANEL ===== */
        .admin-container {
            display: none;
        }
        
        .admin-header {
            background: linear-gradient(135deg, var(--primary-green), var(--dark-green));
            color: white;
            padding: 20px 0;
            margin-bottom: 30px;
        }
        
        /* ===== SIDEBAR / TABS ===== */
        .nav-pills .nav-link {
            color: #333;
            border-radius: 10px;
            margin-bottom: 5px;
            transition: all 0.3s;
            text-align: left;
        }
        
        .nav-pills .nav-link:hover {
            background: var(--light-green);
        }
        
        .nav-pills .nav-link.active {
            background: var(--primary-green);
            color: white;
        }
        
        .nav-pills .nav-link i {
            width: 25px;
        }
        
        /* ===== CARDS ===== */
        .card {
            border: none;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.08);
        }
        
        .card-header {
            background: white;
            border-bottom: 1px solid #eee;
            padding: 20px;
            border-radius: 15px 15px 0 0 !important;
        }
        
        /* ===== TABLE ===== */
        .table {
            margin-bottom: 0;
        }
        
        .table th {
            border-top: none;
            font-weight: 600;
            font-size: 0.85rem;
        }
        
        .table td {
            vertical-align: middle;
        }
        
        /* ===== BUTTONS ===== */
        .btn-success {
            background: var(--primary-green);
            border-color: var(--primary-green);
        }
        
        .btn-success:hover {
            background: var(--dark-green);
            border-color: var(--dark-green);
        }
        
        /* ===== MODAL ===== */
        .modal-header.bg-success {
            background: linear-gradient(135deg, var(--primary-green), var(--dark-green)) !important;
        }
        
        /* ===== FORM ===== */
        .form-control:focus,
        .form-select:focus {
            border-color: var(--primary-green);
            box-shadow: 0 0 0 0.2rem rgba(25, 135, 84, 0.15);
        }
        
        /* ===== PREVIEW IMAGE ===== */
        .preview-img {
            max-width: 100%;
            max-height: 150px;
            object-fit: cover;
            border-radius: 10px;
            margin-top: 10px;
        }
        
        /* ===== THUMBNAIL TABLE ===== */
        .thumb-img {
            width: 60px;
            height: 40px;
            object-fit: cover;
            border-radius: 5px;
        }
        
        /* ===== BADGE CUSTOM ===== */
        .bg-purple {
            background-color: #C13584 !important;
        }
        
        /* ===== SOCIAL INPUT GROUP ===== */
        .social-input-group {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
        }
        
        .social-input-group .input-group-text {
            width: 45px;
            justify-content: center;
        }
        
        .social-input-group .input-group-text.facebook { background: #1877f2; color: white; }
        .social-input-group .input-group-text.instagram { background: linear-gradient(45deg, #f09433, #dc2743); color: white; }
        .social-input-group .input-group-text.youtube { background: #ff0000; color: white; }
        .social-input-group .input-group-text.whatsapp { background: #25d366; color: white; }
        
        /* ===== RESPONSIVE ===== */
        @media (max-width: 991px) {
            .nav-pills {
                flex-direction: row !important;
                flex-wrap: nowrap;
                overflow-x: auto;
                padding-bottom: 10px;
                gap: 5px;
            }
            
            .nav-pills .nav-link {
                white-space: nowrap;
                padding: 10px 15px;
                font-size: 0.85rem;
            }
            
            .nav-pills .nav-link span {
                display: none;
            }
            
            .nav-pills .nav-link i {
                width: auto;
                margin: 0;
            }
        }
        
        @media (max-width: 768px) {
            .admin-header h4 {
                font-size: 1.1rem;
            }
            
            .table {
                font-size: 0.8rem;
            }
            
            .btn-sm {
                padding: 0.2rem 0.4rem;
                font-size: 0.75rem;
            }
            
            .login-box {
                margin: 20px;
                padding: 30px 20px;
            }
        }
        
        /* ===== LOADING OVERLAY ===== */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(255,255,255,0.9);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
        }
        
        .loading-overlay.d-none {
            display: none !important;
        }
        
        /* ===== PROFIL PREVIEW ===== */
        .profil-preview {
            background: linear-gradient(135deg, var(--primary-green), var(--dark-green));
            color: white;
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            margin-bottom: 20px;
        }
        
        .profil-preview i {
            font-size: 3rem;
            margin-bottom: 10px;
            color: #ffc107;
        }
    </style>
</head>
<body>
    
    <!-- ========== LOADING OVERLAY ========== -->
    <div class="loading-overlay d-none" id="loadingOverlay">
        <div class="text-center">
            <div class="spinner-border text-success mb-3" style="width: 3rem; height: 3rem;"></div>
            <p class="fw-bold text-success">Menyimpan data...</p>
        </div>
    </div>
    
    <!-- ========== LOGIN PAGE ========== -->
    <div class="login-container" id="loginPage">
        <div class="login-box text-center">
            <i class="fas fa-mosque logo mb-3"></i>
            <h4 class="fw-bold mb-4">Admin Masjid</h4>
            <form id="formLogin">
                <div class="mb-3">
                    <div class="input-group">
                        <span class="input-group-text"><i class="fas fa-user"></i></span>
                        <input type="text" class="form-control" id="inputUsername" placeholder="Username" required>
                    </div>
                </div>
                <div class="mb-4">
                    <div class="input-group">
                        <span class="input-group-text"><i class="fas fa-lock"></i></span>
                        <input type="password" class="form-control" id="inputPassword" placeholder="Password" required>
                    </div>
                </div>
                <button type="submit" class="btn btn-success w-100 py-2">
                    <i class="fas fa-sign-in-alt me-2"></i>Masuk
                </button>
            </form>
            <div class="mt-4">
                <a href="index.html" class="text-muted text-decoration-none">
                    <i class="fas fa-arrow-left me-1"></i>Kembali ke Website
                </a>
            </div>
        </div>
    </div>
    
    <!-- ========== ADMIN PANEL ========== -->
    <div class="admin-container" id="adminPanel">
        
        <!-- Header -->
        <div class="admin-header">
            <div class="container">
                <div class="d-flex justify-content-between align-items-center">
                    <h4 class="mb-0">
                        <i class="fas fa-mosque me-2"></i><span id="headerNamaMasjid">Admin Panel</span>
                    </h4>
                    <div>
                        <a href="index.html" class="btn btn-outline-light btn-sm me-2">
                            <i class="fas fa-eye"></i> <span class="d-none d-md-inline">Lihat Website</span>
                        </a>
                        <button class="btn btn-outline-light btn-sm" onclick="logout()">
                            <i class="fas fa-sign-out-alt"></i> <span class="d-none d-md-inline">Logout</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Main Content -->
        <div class="container pb-5">
            <div class="row">
                
                <!-- Sidebar / Navigation -->
                <div class="col-lg-3 mb-4">
                    <div class="card">
                        <div class="card-body p-2">
                            <nav class="nav nav-pills flex-column" id="adminNav">
                                <button class="nav-link active" data-bs-toggle="pill" data-bs-target="#tab-profil">
                                    <i class="fas fa-mosque"></i> <span>Profil Masjid</span>
                                </button>
                                <button class="nav-link" data-bs-toggle="pill" data-bs-target="#tab-pengurus">
                                    <i class="fas fa-users"></i> <span>Pengurus</span>
                                </button>
                                <button class="nav-link" data-bs-toggle="pill" data-bs-target="#tab-kajian">
                                    <i class="fas fa-book-open"></i> <span>Kajian</span>
                                </button>
                                <button class="nav-link" data-bs-toggle="pill" data-bs-target="#tab-pengumuman">
                                    <i class="fas fa-bullhorn"></i> <span>Pengumuman</span>
                                </button>
                                <button class="nav-link" data-bs-toggle="pill" data-bs-target="#tab-kisah">
                                    <i class="fas fa-book"></i> <span>Kisah</span>
                                </button>
                                <button class="nav-link" data-bs-toggle="pill" data-bs-target="#tab-galeri">
                                    <i class="fas fa-images"></i> <span>Galeri</span>
                                </button>
                                <button class="nav-link" data-bs-toggle="pill" data-bs-target="#tab-serbasabi">
                                    <i class="fas fa-newspaper"></i> <span>Serba Serbi</span>
                                </button>
                                <button class="nav-link" data-bs-toggle="pill" data-bs-target="#tab-keuangan">
                                    <i class="fas fa-wallet"></i> <span>Keuangan</span>
                                </button>
                                <button class="nav-link" data-bs-toggle="pill" data-bs-target="#tab-zakat">
                                    <i class="fas fa-hand-holding-heart"></i> <span>Zakat</span>
                                </button>
                                <button class="nav-link" data-bs-toggle="pill" data-bs-target="#tab-rekening">
                                    <i class="fas fa-university"></i> <span>Rekening</span>
                                </button>
                            </nav>
                        </div>
                    </div>
                </div>
                
                <!-- Tab Content -->
                <div class="col-lg-9">
                    <div class="tab-content">
                        
                        <!-- ========== TAB PROFIL MASJID ========== -->
                        <div class="tab-pane fade show active" id="tab-profil">
                            <div class="card">
                                <div class="card-header">
                                    <h5 class="mb-0"><i class="fas fa-mosque me-2 text-success"></i>Profil Masjid</h5>
                                </div>
                                <div class="card-body">
                                    
                                    <!-- Preview -->
                                    <div class="profil-preview">
                                        <i class="fas fa-mosque"></i>
                                        <h4 id="previewNamaMasjid">Masjid Mekarindah</h4>
                                        <p class="mb-0 opacity-75" id="previewAlamat">Alamat belum diisi</p>
                                    </div>
                                    
                                    <div class="row">
                                        <!-- Kolom Kiri -->
                                        <div class="col-md-6">
                                            <h6 class="fw-bold text-success mb-3"><i class="fas fa-info-circle me-2"></i>Informasi Dasar</h6>
                                            
                                            <div class="mb-3">
                                                <label class="form-label">Nama Masjid *</label>
                                                <input type="text" class="form-control" id="profilNama" placeholder="Contoh: Masjid Al-Ikhlas">
                                            </div>
                                            
                                            <div class="mb-3">
                                                <label class="form-label">Alamat *</label>
                                                <textarea class="form-control" id="profilAlamat" rows="2" placeholder="Alamat lengkap masjid"></textarea>
                                            </div>
                                            
                                            <div class="mb-3">
                                                <label class="form-label">Telepon</label>
                                                <input type="text" class="form-control" id="profilTelepon" placeholder="Contoh: +62 812-3456-7890">
                                            </div>
                                            
                                            <div class="mb-3">
                                                <label class="form-label">Email</label>
                                                <input type="email" class="form-control" id="profilEmail" placeholder="Contoh: info@masjid.com">
                                            </div>
                                            
                                            <div class="mb-3">
                                                <label class="form-label">Deskripsi Masjid</label>
                                                <textarea class="form-control" id="profilDeskripsi" rows="4" placeholder="Ceritakan tentang masjid ini..."></textarea>
                                            </div>
                                        </div>
                                        
                                        <!-- Kolom Kanan -->
                                        <div class="col-md-6">
                                            <h6 class="fw-bold text-success mb-3"><i class="fas fa-bullseye me-2"></i>Visi & Misi</h6>
                                            
                                            <div class="mb-3">
                                                <label class="form-label">Visi</label>
                                                <textarea class="form-control" id="profilVisi" rows="3" placeholder="Visi masjid..."></textarea>
                                            </div>
                                            
                                            <div class="mb-3">
                                                <label class="form-label">Misi</label>
                                                <textarea class="form-control" id="profilMisi" rows="5" placeholder="1. Misi pertama&#10;2. Misi kedua&#10;3. Misi ketiga"></textarea>
                                                <small class="text-muted">Pisahkan dengan enter untuk setiap poin misi</small>
                                            </div>
                                            
                                            <h6 class="fw-bold text-success mb-3 mt-4"><i class="fas fa-share-alt me-2"></i>Media Sosial</h6>
                                            
                                            <div class="social-input-group">
                                                <div class="input-group mb-2">
                                                    <span class="input-group-text facebook"><i class="fab fa-facebook-f"></i></span>
                                                    <input type="url" class="form-control" id="profilFacebook" placeholder="https://facebook.com/namapage">
                                                </div>
                                                
                                                <div class="input-group mb-2">
                                                    <span class="input-group-text instagram"><i class="fab fa-instagram"></i></span>
                                                    <input type="url" class="form-control" id="profilInstagram" placeholder="https://instagram.com/username">
                                                </div>
                                                
                                                <div class="input-group mb-2">
                                                    <span class="input-group-text youtube"><i class="fab fa-youtube"></i></span>
                                                    <input type="url" class="form-control" id="profilYoutube" placeholder="https://youtube.com/@channel">
                                                </div>
                                                
                                                <div class="input-group">
                                                    <span class="input-group-text whatsapp"><i class="fab fa-whatsapp"></i></span>
                                                    <input type="text" class="form-control" id="profilWhatsapp" placeholder="6281234567890 (tanpa + atau spasi)">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <hr>
                                    
                                    <div class="text-end">
                                        <button class="btn btn-success btn-lg" onclick="simpanProfil()">
                                            <i class="fas fa-save me-2"></i>Simpan Profil
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- ========== TAB PENGURUS ========== -->
                        <div class="tab-pane fade" id="tab-pengurus">
                            <div class="card">
                                <div class="card-header d-flex justify-content-between align-items-center">
                                    <h5 class="mb-0"><i class="fas fa-users me-2 text-success"></i>Pengurus Masjid</h5>
                                    <button class="btn btn-success btn-sm" onclick="showModalPengurus()">
                                        <i class="fas fa-plus"></i> Tambah
                                    </button>
                                </div>
                                <div class="card-body">
                                    <div class="table-responsive">
                                        <table class="table table-hover">
                                            <thead class="table-success">
                                                <tr>
                                                    <th>No</th>
                                                    <th>Foto</th>
                                                    <th>Nama</th>
                                                    <th>Jabatan</th>
                                                    <th>Aksi</th>
                                                </tr>
                                            </thead>
                                            <tbody id="tabelPengurus">
                                                <tr><td colspan="5" class="text-center">Memuat...</td></tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- ========== TAB KAJIAN ========== -->
                        <div class="tab-pane fade" id="tab-kajian">
                            <div class="card">
                                <div class="card-header d-flex justify-content-between align-items-center">
                                    <h5 class="mb-0"><i class="fas fa-book-open me-2 text-success"></i>Jadwal Kajian</h5>
                                    <button class="btn btn-success btn-sm" onclick="showModalKajian()">
                                        <i class="fas fa-plus"></i> Tambah
                                    </button>
                                </div>
                                <div class="card-body">
                                    <div class="table-responsive">
                                        <table class="table table-hover">
                                            <thead class="table-success">
                                                <tr>
                                                    <th>No</th>
                                                    <th>Judul</th>
                                                    <th>Pemateri</th>
                                                    <th>Hari</th>
                                                    <th>Waktu</th>
                                                    <th>Aksi</th>
                                                </tr>
                                            </thead>
                                            <tbody id="tabelKajian">
                                                <tr><td colspan="6" class="text-center">Memuat...</td></tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- ========== TAB PENGUMUMAN ========== -->
                        <div class="tab-pane fade" id="tab-pengumuman">
                            <div class="card">
                                <div class="card-header d-flex justify-content-between align-items-center">
                                    <h5 class="mb-0"><i class="fas fa-bullhorn me-2 text-success"></i>Pengumuman</h5>
                                    <button class="btn btn-success btn-sm" onclick="showModalPengumuman()">
                                        <i class="fas fa-plus"></i> Tambah
                                    </button>
                                </div>
                                <div class="card-body">
                                    <div class="table-responsive">
                                        <table class="table table-hover">
                                            <thead class="table-success">
                                                <tr>
                                                    <th>No</th>
                                                    <th>Tanggal</th>
                                                    <th>Judul</th>
                                                    <th>Aksi</th>
                                                </tr>
                                            </thead>
                                            <tbody id="tabelPengumuman">
                                                <tr><td colspan="4" class="text-center">Memuat...</td></tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- ========== TAB KISAH INSPIRATIF ========== -->
                        <div class="tab-pane fade" id="tab-kisah">
                            <div class="card">
                                <div class="card-header d-flex justify-content-between align-items-center">
                                    <h5 class="mb-0"><i class="fas fa-book me-2 text-success"></i>Kisah Inspiratif</h5>
                                    <button class="btn btn-success btn-sm" onclick="showModalKisah()">
                                        <i class="fas fa-plus"></i> Tambah
                                    </button>
                                </div>
                                <div class="card-body">
                                    <div class="table-responsive">
                                        <table class="table table-hover">
                                            <thead class="table-success">
                                                <tr>
                                                    <th>No</th>
                                                    <th>Gambar</th>
                                                    <th>Judul</th>
                                                    <th>Aksi</th>
                                                </tr>
                                            </thead>
                                            <tbody id="tabelKisah">
                                                <tr><td colspan="4" class="text-center">Memuat...</td></tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- ========== TAB GALERI ========== -->
                        <div class="tab-pane fade" id="tab-galeri">
                            <div class="card">
                                <div class="card-header d-flex justify-content-between align-items-center">
                                    <h5 class="mb-0"><i class="fas fa-images me-2 text-success"></i>Galeri</h5>
                                    <button class="btn btn-success btn-sm" onclick="showModalGaleri()">
                                        <i class="fas fa-plus"></i> Tambah
                                    </button>
                                </div>
                                <div class="card-body">
                                    <div class="alert alert-info">
                                        <i class="fas fa-info-circle me-2"></i>
                                        <strong>Tipe:</strong> 
                                        <span class="badge bg-success">Foto</span>
                                        <span class="badge bg-danger">YouTube</span>
                                        <span class="badge bg-purple">Instagram</span>
                                        <span class="badge bg-dark">TikTok</span>
                                    </div>
                                    <div class="table-responsive">
                                        <table class="table table-hover">
                                            <thead class="table-success">
                                                <tr>
                                                    <th>No</th>
                                                    <th>Tipe</th>
                                                    <th>Preview</th>
                                                    <th>Judul</th>
                                                    <th>Aksi</th>
                                                </tr>
                                            </thead>
                                            <tbody id="tabelGaleri">
                                                <tr><td colspan="5" class="text-center">Memuat...</td></tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- ========== TAB SERBA SERBI ========== -->
                        <div class="tab-pane fade" id="tab-serbasabi">
                            <div class="card">
                                <div class="card-header d-flex justify-content-between align-items-center">
                                    <h5 class="mb-0"><i class="fas fa-newspaper me-2 text-success"></i>Serba Serbi</h5>
                                    <button class="btn btn-success btn-sm" onclick="showModalSerbasabi()">
                                        <i class="fas fa-plus"></i> Tambah
                                    </button>
                                </div>
                                <div class="card-body">
                                    <div class="alert alert-info">
                                        <i class="fas fa-info-circle me-2"></i>
                                        Artikel dengan gambar dan isi panjang
                                    </div>
                                    <div class="table-responsive">
                                        <table class="table table-hover">
                                            <thead class="table-success">
                                                <tr>
                                                    <th>No</th>
                                                    <th>Gambar</th>
                                                    <th>Judul</th>
                                                    <th>Aksi</th>
                                                </tr>
                                            </thead>
                                            <tbody id="tabelSerbasabi">
                                                <tr><td colspan="4" class="text-center">Memuat...</td></tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- ========== TAB KEUANGAN ========== -->
                        <div class="tab-pane fade" id="tab-keuangan">
                            <div class="card">
                                <div class="card-header d-flex justify-content-between align-items-center">
                                    <h5 class="mb-0"><i class="fas fa-wallet me-2 text-success"></i>Keuangan Masjid</h5>
                                    <button class="btn btn-success btn-sm" onclick="showModalKeuangan()">
                                        <i class="fas fa-plus"></i> Tambah Transaksi
                                    </button>
                                </div>
                                <div class="card-body">
                                    <div class="row mb-4">
                                        <div class="col-md-6">
                                            <div class="input-group">
                                                <span class="input-group-text">Saldo Awal</span>
                                                <input type="number" class="form-control" id="saldoAwalKeuangan" placeholder="0">
                                                <button class="btn btn-success" onclick="simpanSaldoAwalKeuangan()">
                                                    <i class="fas fa-save"></i>
                                                </button>
                                            </div>
                                        </div>
                                        <div class="col-md-6 mt-2 mt-md-0">
                                            <div class="alert alert-success mb-0 py-2">
                                                <strong>Saldo:</strong> <span id="saldoKeuanganAdmin">Rp 0</span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="table-responsive">
                                        <table class="table table-hover">
                                            <thead class="table-success">
                                                <tr>
                                                    <th>No</th>
                                                    <th>Tanggal</th>
                                                    <th>Keterangan</th>
                                                    <th>Jenis</th>
                                                    <th>Jumlah</th>
                                                    <th>Aksi</th>
                                                </tr>
                                            </thead>
                                            <tbody id="tabelKeuangan">
                                                <tr><td colspan="6" class="text-center">Memuat...</td></tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- ========== TAB ZAKAT ========== -->
                        <div class="tab-pane fade" id="tab-zakat">
                            <div class="card">
                                <div class="card-header d-flex justify-content-between align-items-center">
                                    <h5 class="mb-0"><i class="fas fa-hand-holding-heart me-2 text-success"></i>Zakat</h5>
                                    <button class="btn btn-success btn-sm" onclick="showModalZakat()">
                                        <i class="fas fa-plus"></i> Tambah Transaksi
                                    </button>
                                </div>
                                <div class="card-body">
                                    <div class="row mb-4">
                                        <div class="col-md-6">
                                            <div class="input-group">
                                                <span class="input-group-text">Saldo Awal</span>
                                                <input type="number" class="form-control" id="saldoAwalZakat" placeholder="0">
                                                <button class="btn btn-success" onclick="simpanSaldoAwalZakat()">
                                                    <i class="fas fa-save"></i>
                                                </button>
                                            </div>
                                        </div>
                                        <div class="col-md-6 mt-2 mt-md-0">
                                            <div class="alert alert-success mb-0 py-2">
                                                <strong>Saldo:</strong> <span id="saldoZakatAdmin">Rp 0</span>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="table-responsive">
                                        <table class="table table-hover">
                                            <thead class="table-success">
                                                <tr>
                                                    <th>No</th>
                                                    <th>Tanggal</th>
                                                    <th>Keterangan</th>
                                                    <th>Jenis</th>
                                                    <th>Jumlah</th>
                                                    <th>Aksi</th>
                                                </tr>
                                            </thead>
                                            <tbody id="tabelZakat">
                                                <tr><td colspan="6" class="text-center">Memuat...</td></tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- ========== TAB REKENING ========== -->
                        <div class="tab-pane fade" id="tab-rekening">
                            <div class="card">
                                <div class="card-header d-flex justify-content-between align-items-center">
                                    <h5 class="mb-0"><i class="fas fa-university me-2 text-success"></i>Rekening Donasi</h5>
                                    <button class="btn btn-success btn-sm" onclick="showModalRekening()">
                                        <i class="fas fa-plus"></i> Tambah
                                    </button>
                                </div>
                                <div class="card-body">
                                    <div class="table-responsive">
                                        <table class="table table-hover">
                                            <thead class="table-success">
                                                <tr>
                                                    <th>No</th>
                                                    <th>Bank</th>
                                                    <th>No. Rekening</th>
                                                    <th>Atas Nama</th>
                                                    <th>Aksi</th>
                                                </tr>
                                            </thead>
                                            <tbody id="tabelRekening">
                                                <tr><td colspan="5" class="text-center">Memuat...</td></tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- ========== MODAL PENGURUS ========== -->
    <div class="modal fade" id="modalPengurus" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header bg-success text-white">
                    <h5 class="modal-title" id="modalPengurusTitle">Tambah Pengurus</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <input type="hidden" id="pengurusId">
                    <div class="mb-3">
                        <label class="form-label">Nama *</label>
                        <input type="text" class="form-control" id="pengurusNama" placeholder="Nama lengkap">
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Jabatan *</label>
                        <input type="text" class="form-control" id="pengurusJabatan" placeholder="Contoh: Ketua DKM">
                    </div>
                    <div class="mb-3">
                        <label class="form-label">URL Foto *</label>
                        <input type="url" class="form-control" id="pengurusFoto" placeholder="https://i.ibb.co/xxx/foto.jpg" oninput="previewImage(this, 'previewPengurus')">
                        <small class="text-muted">Upload di imgbb.com, ukuran 200x200 px</small>
                        <img id="previewPengurus" class="preview-img d-none">
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Batal</button>
                    <button type="button" class="btn btn-success" onclick="simpanPengurus()">
                        <i class="fas fa-save me-1"></i>Simpan
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- ========== MODAL KAJIAN ========== -->
    <div class="modal fade" id="modalKajian" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header bg-success text-white">
                    <h5 class="modal-title" id="modalKajianTitle">Tambah Kajian</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <input type="hidden" id="kajianId">
                    <div class="mb-3">
                        <label class="form-label">Judul Kajian *</label>
                        <input type="text" class="form-control" id="kajianJudul" placeholder="Contoh: Kajian Fiqih">
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Pemateri *</label>
                        <input type="text" class="form-control" id="kajianPemateri" placeholder="Nama ustadz">
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Hari *</label>
                        <select class="form-select" id="kajianHari">
                            <option value="Senin">Senin</option>
                            <option value="Selasa">Selasa</option>
                            <option value="Rabu">Rabu</option>
                            <option value="Kamis">Kamis</option>
                            <option value="Jumat">Jumat</option>
                            <option value="Sabtu">Sabtu</option>
                            <option value="Ahad">Ahad</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Waktu *</label>
                        <input type="text" class="form-control" id="kajianWaktu" placeholder="Contoh: Ba'da Maghrib">
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Batal</button>
                    <button type="button" class="btn btn-success" onclick="simpanKajian()">
                        <i class="fas fa-save me-1"></i>Simpan
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- ========== MODAL PENGUMUMAN ========== -->
    <div class="modal fade" id="modalPengumuman" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header bg-success text-white">
                    <h5 class="modal-title" id="modalPengumumanTitle">Tambah Pengumuman</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <input type="hidden" id="pengumumanId">
                    <div class="mb-3">
                        <label class="form-label">Tanggal *</label>
                        <input type="date" class="form-control" id="pengumumanTanggal">
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Judul *</label>
                        <input type="text" class="form-control" id="pengumumanJudul" placeholder="Judul pengumuman">
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Isi *</label>
                        <textarea class="form-control" id="pengumumanIsi" rows="4" placeholder="Isi pengumuman..."></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Batal</button>
                    <button type="button" class="btn btn-success" onclick="simpanPengumuman()">
                        <i class="fas fa-save me-1"></i>Simpan
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- ========== MODAL KISAH ========== -->
    <div class="modal fade" id="modalKisah" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header bg-success text-white">
                    <h5 class="modal-title" id="modalKisahTitle">Tambah Kisah</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <input type="hidden" id="kisahId">
                    <div class="mb-3">
                        <label class="form-label">Judul *</label>
                        <input type="text" class="form-control" id="kisahJudul" placeholder="Judul kisah">
                    </div>
                    <div class="mb-3">
                        <label class="form-label">URL Gambar *</label>
                        <input type="url" class="form-control" id="kisahGambar" placeholder="https://i.ibb.co/xxx/gambar.jpg" oninput="previewImage(this, 'previewKisah')">
                        <img id="previewKisah" class="preview-img d-none">
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Isi Kisah *</label>
                        <textarea class="form-control" id="kisahIsi" rows="10" placeholder="Tulis kisah lengkap..."></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Batal</button>
                    <button type="button" class="btn btn-success" onclick="simpanKisah()">
                        <i class="fas fa-save me-1"></i>Simpan
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- ========== MODAL GALERI ========== -->
    <div class="modal fade" id="modalGaleri" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header bg-success text-white">
                    <h5 class="modal-title" id="modalGaleriTitle">Tambah Galeri</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <input type="hidden" id="galeriId">
                    
                    <div class="mb-3">
                        <label class="form-label">Tipe Konten *</label>
                        <select class="form-select" id="galeriTipe" onchange="onGaleriTipeChange()">
                            <option value="foto"> Foto</option>
                            <option value="youtube"> YouTube</option>
                            <option value="instagram"> Instagram</option>
                            <option value="tiktok"> TikTok</option>
                        </select>
                    </div>
                    
                    <div class="mb-3">
                        <label class="form-label">Judul *</label>
                        <input type="text" class="form-control" id="galeriJudul" placeholder="Judul galeri">
                    </div>
                    
                    <div class="mb-3" id="wrapperUrlFoto">
                        <label class="form-label">URL Foto *</label>
                        <input type="url" class="form-control" id="galeriUrlFoto" placeholder="https://i.ibb.co/xxx/foto.jpg" oninput="previewImage(this, 'previewGaleri')">
                        <small class="text-muted">Upload di imgbb.com, 1200x600 px</small>
                    </div>
                    
                    <div class="mb-3 d-none" id="wrapperUrlYoutube">
                        <label class="form-label">URL YouTube *</label>
                        <input type="url" class="form-control" id="galeriUrlYoutube" placeholder="https://youtube.com/watch?v=xxxxx">
                    </div>
                    
                    <div class="mb-3 d-none" id="wrapperUrlInstagram">
                        <label class="form-label">URL Instagram *</label>
                        <input type="url" class="form-control" id="galeriUrlInstagram" placeholder="https://instagram.com/p/xxxxx/">
                    </div>
                    
                    <div class="mb-3 d-none" id="wrapperUrlTiktok">
                        <label class="form-label">URL TikTok *</label>
                        <input type="url" class="form-control" id="galeriUrlTiktok" placeholder="https://tiktok.com/@user/video/xxxxx">
                    </div>
                    
                    <img id="previewGaleri" class="preview-img d-none">
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Batal</button>
                    <button type="button" class="btn btn-success" onclick="simpanGaleri()">
                        <i class="fas fa-save me-1"></i>Simpan
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- ========== MODAL SERBA SERBI ========== -->
    <div class="modal fade" id="modalSerbasabi" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header bg-success text-white">
                    <h5 class="modal-title" id="modalSerbasabiTitle">Tambah Serba Serbi</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <input type="hidden" id="serbasabiId">
                    <div class="mb-3">
                        <label class="form-label">Judul *</label>
                        <input type="text" class="form-control" id="serbasabiJudul" placeholder="Judul artikel">
                    </div>
                    <div class="mb-3">
                        <label class="form-label">URL Gambar *</label>
                        <input type="url" class="form-control" id="serbasabiGambar" placeholder="https://i.ibb.co/xxx/gambar.jpg" oninput="previewImage(this, 'previewSerbasabi')">
                        <img id="previewSerbasabi" class="preview-img d-none">
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Isi Artikel *</label>
                        <textarea class="form-control" id="serbasabiIsi" rows="10" placeholder="Tulis isi artikel..."></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Batal</button>
                    <button type="button" class="btn btn-success" onclick="simpanSerbasabi()">
                        <i class="fas fa-save me-1"></i>Simpan
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- ========== MODAL KEUANGAN ========== -->
    <div class="modal fade" id="modalKeuangan" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header bg-success text-white">
                    <h5 class="modal-title">Tambah Transaksi</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label class="form-label">Tanggal *</label>
                        <input type="date" class="form-control" id="keuanganTanggal">
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Keterangan *</label>
                        <input type="text" class="form-control" id="keuanganKeterangan" placeholder="Keterangan">
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Jenis *</label>
                        <select class="form-select" id="keuanganJenis">
                            <option value="masuk">Pemasukan</option>
                            <option value="keluar">Pengeluaran</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Jumlah (Rp) *</label>
                        <input type="number" class="form-control" id="keuanganJumlah" placeholder="0">
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Batal</button>
                    <button type="button" class="btn btn-success" onclick="simpanKeuangan()">
                        <i class="fas fa-save me-1"></i>Simpan
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- ========== MODAL ZAKAT ========== -->
    <div class="modal fade" id="modalZakat" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header bg-success text-white">
                    <h5 class="modal-title">Tambah Transaksi Zakat</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <div class="mb-3">
                        <label class="form-label">Tanggal *</label>
                        <input type="date" class="form-control" id="zakatTanggal">
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Keterangan *</label>
                        <input type="text" class="form-control" id="zakatKeterangan" placeholder="Keterangan">
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Jenis *</label>
                        <select class="form-select" id="zakatJenis">
                            <option value="masuk">Zakat Masuk</option>
                            <option value="keluar">Zakat Disalurkan</option>
                        </select>
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Jumlah (Rp) *</label>
                        <input type="number" class="form-control" id="zakatJumlah" placeholder="0">
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Batal</button>
                    <button type="button" class="btn btn-success" onclick="simpanZakat()">
                        <i class="fas fa-save me-1"></i>Simpan
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- ========== MODAL REKENING ========== -->
    <div class="modal fade" id="modalRekening" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header bg-success text-white">
                    <h5 class="modal-title" id="modalRekeningTitle">Tambah Rekening</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <input type="hidden" id="rekeningId">
                    <div class="mb-3">
                        <label class="form-label">Nama Bank *</label>
                        <input type="text" class="form-control" id="rekeningBank" placeholder="Contoh: Bank BCA">
                    </div>
                    <div class="mb-3">
                        <label class="form-label">No. Rekening *</label>
                        <input type="text" class="form-control" id="rekeningNorek" placeholder="1234567890">
                    </div>
                    <div class="mb-3">
                        <label class="form-label">Atas Nama *</label>
                        <input type="text" class="form-control" id="rekeningAtasnama" placeholder="Nama pemilik">
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Batal</button>
                    <button type="button" class="btn btn-success" onclick="simpanRekening()">
                        <i class="fas fa-save me-1"></i>Simpan
                    </button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    
    <script>
        // ===== KONFIGURASI =====
        const BIN_ID = '695b57e0d0ea881f40552974';
        const API_KEY = '$2a$10$mu94DGoU.bNfbEUgWcjffueeAaIQfeb2hMzp.TM.Tg6M8JiaUOIVm';
        
        const ADMIN_USER = 'admin';
        const ADMIN_PASS = 'mekarindah2025';
        
        // ===== DATA GLOBAL =====
        let allData = {};
        
        // ===== LOGIN =====
        document.getElementById('formLogin').addEventListener('submit', function(e) {
            e.preventDefault();
            const user = document.getElementById('inputUsername').value;
            const pass = document.getElementById('inputPassword').value;
            
            if (user === ADMIN_USER && pass === ADMIN_PASS) {
                document.getElementById('loginPage').style.display = 'none';
                document.getElementById('adminPanel').style.display = 'block';
                sessionStorage.setItem('adminLoggedIn', 'true');
                loadAllData();
            } else {
                alert('Username atau password salah!');
            }
        });
        
        function logout() {
            sessionStorage.removeItem('adminLoggedIn');
            location.reload();
        }
        
        // Check session
        if (sessionStorage.getItem('adminLoggedIn') === 'true') {
            document.getElementById('loginPage').style.display = 'none';
            document.getElementById('adminPanel').style.display = 'block';
            loadAllData();
        }
        
        // ===== LOADING =====
        function showLoading() {
            document.getElementById('loadingOverlay').classList.remove('d-none');
        }
        
        function hideLoading() {
            document.getElementById('loadingOverlay').classList.add('d-none');
        }
        
        // ===== LOAD ALL DATA =====
        async function loadAllData() {
            try {
                const response = await fetch('https://api.jsonbin.io/v3/b/' + BIN_ID + '/latest', {
                    headers: { 'X-Master-Key': API_KEY }
                });
                const json = await response.json();
                allData = json.record;
                
                // Initialize profil
                if (!allData.profil) {
                    allData.profil = {
                        nama: 'Masjid Mekarindah',
                        telepon: '',
                        alamat: '',
                        email: '',
                        deskripsi: '',
                        visi: '',
                        misi: '',
                        sosmed: { facebook: '', instagram: '', youtube: '', whatsapp: '' }
                    };
                }
                if (!allData.profil.sosmed) {
                    allData.profil.sosmed = { facebook: '', instagram: '', youtube: '', whatsapp: '' };
                }
                
                // Initialize arrays
                if (!allData.pengurus) allData.pengurus = [];
                if (!allData.kajian) allData.kajian = [];
                if (!allData.pengumuman) allData.pengumuman = [];
                if (!allData.kisah) allData.kisah = [];
                if (!allData.galeri) allData.galeri = [];
                if (!allData.serbasabi) allData.serbasabi = [];
                if (!allData.rekening) allData.rekening = [];
                
                // Initialize keuangan
                if (!allData.keuangan) {
                    allData.keuangan = { saldoAwal: 0, transaksi: [] };
                }
                if (!allData.keuangan.saldoAwal) allData.keuangan.saldoAwal = 0;
                if (!allData.keuangan.transaksi) allData.keuangan.transaksi = [];
                
                // Initialize zakat
                if (!allData.zakat) {
                    allData.zakat = { saldoAwal: 0, transaksi: [] };
                }
                if (!allData.zakat.saldoAwal) allData.zakat.saldoAwal = 0;
                if (!allData.zakat.transaksi) allData.zakat.transaksi = [];
                
                renderAll();
                
            } catch (error) {
                console.error('Error:', error);
                alert('Gagal memuat data!');
            }
        }
        
        // ===== SAVE TO JSONBIN =====
        async function saveData() {
            showLoading();
            try {
                await fetch('https://api.jsonbin.io/v3/b/' + BIN_ID, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-Master-Key': API_KEY
                    },
                    body: JSON.stringify(allData)
                });
                hideLoading();
                return true;
            } catch (error) {
                console.error('Error:', error);
                hideLoading();
                alert('Gagal menyimpan!');
                return false;
            }
        }
        
        // ===== RENDER ALL =====
        function renderAll() {
            renderProfil();
            renderTabelPengurus();
            renderTabelKajian();
            renderTabelPengumuman();
            renderTabelKisah();
            renderTabelGaleri();
            renderTabelSerbasabi();
            renderTabelKeuangan();
            renderTabelZakat();
            renderTabelRekening();
        }
        
        // ===== HELPERS =====
        function previewImage(input, previewId) {
            const preview = document.getElementById(previewId);
            if (input.value) {
                preview.src = input.value;
                preview.classList.remove('d-none');
            } else {
                preview.classList.add('d-none');
            }
        }
        
        function formatRupiah(angka) {
            return 'Rp ' + angka.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ".");
        }
        
        function extractYoutubeId(url) {
            const regex = /(?:youtube\.com\/(?:[^\/]+\/.+\/|(?:v|e(?:mbed)?)\/|.*[?&]v=)|youtu\.be\/)([^"&?\/\s]{11})/;
            const match = url.match(regex);
            if (match && match[1]) return match[1];
            return '';
        }
        
        function getBadgeClass(tipe) {
            if (tipe === 'foto') return 'bg-success';
            if (tipe === 'youtube') return 'bg-danger';
            if (tipe === 'instagram') return 'bg-purple';
            if (tipe === 'tiktok') return 'bg-dark';
            return 'bg-secondary';
        }
        
        // ========================================
        // PROFIL MASJID
        // ========================================
        function renderProfil() {
            const p = allData.profil;
            
            // Update header
            document.getElementById('headerNamaMasjid').textContent = p.nama ? p.nama : 'Admin Panel';
            
            // Update preview
            document.getElementById('previewNamaMasjid').textContent = p.nama ? p.nama : 'Masjid';
            document.getElementById('previewAlamat').textContent = p.alamat ? p.alamat : 'Alamat belum diisi';
            
            // Fill form
            document.getElementById('profilNama').value = p.nama ? p.nama : '';
            document.getElementById('profilAlamat').value = p.alamat ? p.alamat : '';
            document.getElementById('profilTelepon').value = p.telepon ? p.telepon : '';
            document.getElementById('profilEmail').value = p.email ? p.email : '';
            document.getElementById('profilDeskripsi').value = p.deskripsi ? p.deskripsi : '';
            document.getElementById('profilVisi').value = p.visi ? p.visi : '';
            document.getElementById('profilMisi').value = p.misi ? p.misi : '';
            
            // Sosmed
            if (p.sosmed) {
                document.getElementById('profilFacebook').value = p.sosmed.facebook ? p.sosmed.facebook : '';
                document.getElementById('profilInstagram').value = p.sosmed.instagram ? p.sosmed.instagram : '';
                document.getElementById('profilYoutube').value = p.sosmed.youtube ? p.sosmed.youtube : '';
                document.getElementById('profilWhatsapp').value = p.sosmed.whatsapp ? p.sosmed.whatsapp : '';
            }
        }
        
        async function simpanProfil() {
            const nama = document.getElementById('profilNama').value.trim();
            
            if (!nama) {
                alert('Nama masjid harus diisi!');
                return;
            }
            
            allData.profil = {
                nama: nama,
                alamat: document.getElementById('profilAlamat').value.trim(),
                telepon: document.getElementById('profilTelepon').value.trim(),
                email: document.getElementById('profilEmail').value.trim(),
                deskripsi: document.getElementById('profilDeskripsi').value.trim(),
                visi: document.getElementById('profilVisi').value.trim(),
                misi: document.getElementById('profilMisi').value.trim(),
                sosmed: {
                    facebook: document.getElementById('profilFacebook').value.trim(),
                    instagram: document.getElementById('profilInstagram').value.trim(),
                    youtube: document.getElementById('profilYoutube').value.trim(),
                    whatsapp: document.getElementById('profilWhatsapp').value.trim()
                }
            };
            
            const success = await saveData();
            if (success) {
                renderProfil();
                alert('Profil berhasil disimpan!');
            }
        }
        
        // ========================================
        // PENGURUS
        // ========================================
        function renderTabelPengurus() {
            const tbody = document.getElementById('tabelPengurus');
            const list = allData.pengurus;
            
            if (list.length === 0) {
                tbody.innerHTML = '<tr><td colspan="5" class="text-center text-muted">Belum ada data</td></tr>';
                return;
            }
            
            tbody.innerHTML = list.map(function(item, index) {
                return '<tr>' +
                    '<td>' + (index + 1) + '</td>' +
                    '<td><img src="' + item.foto + '" class="thumb-img" onerror="this.src=\'https://via.placeholder.com/60x40\'"></td>' +
                    '<td>' + item.nama + '</td>' +
                    '<td>' + item.jabatan + '</td>' +
                    '<td>' +
                        '<button class="btn btn-warning btn-sm me-1" onclick="editPengurus(' + item.id + ')"><i class="fas fa-edit"></i></button>' +
                        '<button class="btn btn-danger btn-sm" onclick="hapusPengurus(' + item.id + ')"><i class="fas fa-trash"></i></button>' +
                    '</td></tr>';
            }).join('');
        }
        
        function showModalPengurus() {
            document.getElementById('pengurusId').value = '';
            document.getElementById('pengurusNama').value = '';
            document.getElementById('pengurusJabatan').value = '';
            document.getElementById('pengurusFoto').value = '';
            document.getElementById('previewPengurus').classList.add('d-none');
            document.getElementById('modalPengurusTitle').textContent = 'Tambah Pengurus';
            new bootstrap.Modal(document.getElementById('modalPengurus')).show();
        }
        
        function editPengurus(id) {
            let item = null;
            for (let i = 0; i < allData.pengurus.length; i++) {
                if (allData.pengurus[i].id === id) { item = allData.pengurus[i]; break; }
            }
            if (!item) return;
            
            document.getElementById('pengurusId').value = item.id;
            document.getElementById('pengurusNama').value = item.nama;
            document.getElementById('pengurusJabatan').value = item.jabatan;
            document.getElementById('pengurusFoto').value = item.foto;
            document.getElementById('previewPengurus').src = item.foto;
            document.getElementById('previewPengurus').classList.remove('d-none');
            document.getElementById('modalPengurusTitle').textContent = 'Edit Pengurus';
            new bootstrap.Modal(document.getElementById('modalPengurus')).show();
        }
        
        async function simpanPengurus() {
            const id = document.getElementById('pengurusId').value;
            const nama = document.getElementById('pengurusNama').value.trim();
            const jabatan = document.getElementById('pengurusJabatan').value.trim();
            const foto = document.getElementById('pengurusFoto').value.trim();
            
            if (!nama || !jabatan || !foto) { alert('Semua field harus diisi!'); return; }
            
            const newItem = { id: id ? parseInt(id) : Date.now(), nama: nama, jabatan: jabatan, foto: foto };
            
            if (id) {
                for (let i = 0; i < allData.pengurus.length; i++) {
                    if (allData.pengurus[i].id === parseInt(id)) { allData.pengurus[i] = newItem; break; }
                }
            } else {
                allData.pengurus.push(newItem);
            }
            
            const success = await saveData();
            if (success) {
                bootstrap.Modal.getInstance(document.getElementById('modalPengurus')).hide();
                renderTabelPengurus();
                alert('Berhasil disimpan!');
            }
        }
        
        async function hapusPengurus(id) {
            if (!confirm('Yakin hapus?')) return;
            allData.pengurus = allData.pengurus.filter(function(x) { return x.id !== id; });
            const success = await saveData();
            if (success) { renderTabelPengurus(); alert('Berhasil dihapus!'); }
        }
        
        // ========================================
        // KAJIAN
        // ========================================
        function renderTabelKajian() {
            const tbody = document.getElementById('tabelKajian');
            const list = allData.kajian;
            
            if (list.length === 0) {
                tbody.innerHTML = '<tr><td colspan="6" class="text-center text-muted">Belum ada data</td></tr>';
                return;
            }
            
            tbody.innerHTML = list.map(function(item, index) {
                return '<tr><td>' + (index + 1) + '</td><td>' + item.judul + '</td><td>' + item.pemateri + '</td><td>' + item.hari + '</td><td>' + item.waktu + '</td><td>' +
                    '<button class="btn btn-warning btn-sm me-1" onclick="editKajian(' + item.id + ')"><i class="fas fa-edit"></i></button>' +
                    '<button class="btn btn-danger btn-sm" onclick="hapusKajian(' + item.id + ')"><i class="fas fa-trash"></i></button></td></tr>';
            }).join('');
        }
        
        function showModalKajian() {
            document.getElementById('kajianId').value = '';
            document.getElementById('kajianJudul').value = '';
            document.getElementById('kajianPemateri').value = '';
            document.getElementById('kajianHari').value = 'Senin';
            document.getElementById('kajianWaktu').value = '';
            new bootstrap.Modal(document.getElementById('modalKajian')).show();
        }
        
        function editKajian(id) {
            let item = null;
            for (let i = 0; i < allData.kajian.length; i++) { if (allData.kajian[i].id === id) { item = allData.kajian[i]; break; } }
            if (!item) return;
            document.getElementById('kajianId').value = item.id;
            document.getElementById('kajianJudul').value = item.judul;
            document.getElementById('kajianPemateri').value = item.pemateri;
            document.getElementById('kajianHari').value = item.hari;
            document.getElementById('kajianWaktu').value = item.waktu;
            new bootstrap.Modal(document.getElementById('modalKajian')).show();
        }
        
        async function simpanKajian() {
            const id = document.getElementById('kajianId').value;
            const judul = document.getElementById('kajianJudul').value.trim();
            const pemateri = document.getElementById('kajianPemateri').value.trim();
            const hari = document.getElementById('kajianHari').value;
            const waktu = document.getElementById('kajianWaktu').value.trim();
            
            if (!judul || !pemateri || !waktu) { alert('Semua field harus diisi!'); return; }
            
            const newItem = { id: id ? parseInt(id) : Date.now(), judul: judul, pemateri: pemateri, hari: hari, waktu: waktu };
            
            if (id) { for (let i = 0; i < allData.kajian.length; i++) { if (allData.kajian[i].id === parseInt(id)) { allData.kajian[i] = newItem; break; } } }
            else { allData.kajian.push(newItem); }
            
            const success = await saveData();
            if (success) { bootstrap.Modal.getInstance(document.getElementById('modalKajian')).hide(); renderTabelKajian(); alert('Berhasil!'); }
        }
        
        async function hapusKajian(id) {
            if (!confirm('Yakin hapus?')) return;
            allData.kajian = allData.kajian.filter(function(x) { return x.id !== id; });
            await saveData(); renderTabelKajian(); alert('Dihapus!');
        }
        
        // ========================================
        // PENGUMUMAN
        // ========================================
        function renderTabelPengumuman() {
            const tbody = document.getElementById('tabelPengumuman');
            const list = allData.pengumuman;
            if (list.length === 0) { tbody.innerHTML = '<tr><td colspan="4" class="text-center text-muted">Belum ada data</td></tr>'; return; }
            tbody.innerHTML = list.map(function(item, index) {
                return '<tr><td>' + (index + 1) + '</td><td>' + item.tanggal + '</td><td>' + item.judul + '</td><td>' +
                    '<button class="btn btn-warning btn-sm me-1" onclick="editPengumuman(' + item.id + ')"><i class="fas fa-edit"></i></button>' +
                    '<button class="btn btn-danger btn-sm" onclick="hapusPengumuman(' + item.id + ')"><i class="fas fa-trash"></i></button></td></tr>';
            }).join('');
        }
        
        function showModalPengumuman() {
            document.getElementById('pengumumanId').value = '';
            document.getElementById('pengumumanTanggal').value = new Date().toISOString().split('T')[0];
            document.getElementById('pengumumanJudul').value = '';
            document.getElementById('pengumumanIsi').value = '';
            new bootstrap.Modal(document.getElementById('modalPengumuman')).show();
        }
        
        function editPengumuman(id) {
            let item = null;
            for (let i = 0; i < allData.pengumuman.length; i++) { if (allData.pengumuman[i].id === id) { item = allData.pengumuman[i]; break; } }
            if (!item) return;
            document.getElementById('pengumumanId').value = item.id;
            document.getElementById('pengumumanTanggal').value = item.tanggal;
            document.getElementById('pengumumanJudul').value = item.judul;
            document.getElementById('pengumumanIsi').value = item.isi;
            new bootstrap.Modal(document.getElementById('modalPengumuman')).show();
        }
        
        async function simpanPengumuman() {
            const id = document.getElementById('pengumumanId').value;
            const tanggal = document.getElementById('pengumumanTanggal').value;
            const judul = document.getElementById('pengumumanJudul').value.trim();
            const isi = document.getElementById('pengumumanIsi').value.trim();
            if (!tanggal || !judul || !isi) { alert('Semua field harus diisi!'); return; }
            const newItem = { id: id ? parseInt(id) : Date.now(), tanggal: tanggal, judul: judul, isi: isi };
            if (id) { for (let i = 0; i < allData.pengumuman.length; i++) { if (allData.pengumuman[i].id === parseInt(id)) { allData.pengumuman[i] = newItem; break; } } }
            else { allData.pengumuman.push(newItem); }
            const success = await saveData();
            if (success) { bootstrap.Modal.getInstance(document.getElementById('modalPengumuman')).hide(); renderTabelPengumuman(); alert('Berhasil!'); }
        }
        
        async function hapusPengumuman(id) {
            if (!confirm('Yakin hapus?')) return;
            allData.pengumuman = allData.pengumuman.filter(function(x) { return x.id !== id; });
            await saveData(); renderTabelPengumuman(); alert('Dihapus!');
        }
        
        // ========================================
        // KISAH INSPIRATIF
        // ========================================
        function renderTabelKisah() {
            const tbody = document.getElementById('tabelKisah');
            const list = allData.kisah;
            if (list.length === 0) { tbody.innerHTML = '<tr><td colspan="4" class="text-center text-muted">Belum ada data</td></tr>'; return; }
            tbody.innerHTML = list.map(function(item, index) {
                return '<tr><td>' + (index + 1) + '</td><td><img src="' + item.gambar + '" class="thumb-img"></td><td>' + item.judul + '</td><td>' +
                    '<button class="btn btn-warning btn-sm me-1" onclick="editKisah(' + item.id + ')"><i class="fas fa-edit"></i></button>' +
                    '<button class="btn btn-danger btn-sm" onclick="hapusKisah(' + item.id + ')"><i class="fas fa-trash"></i></button></td></tr>';
            }).join('');
        }
        
        function showModalKisah() {
            document.getElementById('kisahId').value = '';
            document.getElementById('kisahJudul').value = '';
            document.getElementById('kisahGambar').value = '';
            document.getElementById('kisahIsi').value = '';
            document.getElementById('previewKisah').classList.add('d-none');
            new bootstrap.Modal(document.getElementById('modalKisah')).show();
        }
        
        function editKisah(id) {
            let item = null;
            for (let i = 0; i < allData.kisah.length; i++) { if (allData.kisah[i].id === id) { item = allData.kisah[i]; break; } }
            if (!item) return;
            document.getElementById('kisahId').value = item.id;
            document.getElementById('kisahJudul').value = item.judul;
            document.getElementById('kisahGambar').value = item.gambar;
            document.getElementById('kisahIsi').value = item.isi;
            document.getElementById('previewKisah').src = item.gambar;
            document.getElementById('previewKisah').classList.remove('d-none');
            new bootstrap.Modal(document.getElementById('modalKisah')).show();
        }
        
        async function simpanKisah() {
            const id = document.getElementById('kisahId').value;
            const judul = document.getElementById('kisahJudul').value.trim();
            const gambar = document.getElementById('kisahGambar').value.trim();
            const isi = document.getElementById('kisahIsi').value.trim();
            if (!judul || !gambar || !isi) { alert('Semua field harus diisi!'); return; }
            const newItem = { id: id ? parseInt(id) : Date.now(), judul: judul, gambar: gambar, isi: isi };
            if (id) { for (let i = 0; i < allData.kisah.length; i++) { if (allData.kisah[i].id === parseInt(id)) { allData.kisah[i] = newItem; break; } } }
            else { allData.kisah.push(newItem); }
            const success = await saveData();
            if (success) { bootstrap.Modal.getInstance(document.getElementById('modalKisah')).hide(); renderTabelKisah(); alert('Berhasil!'); }
        }
        
        async function hapusKisah(id) {
            if (!confirm('Yakin hapus?')) return;
            allData.kisah = allData.kisah.filter(function(x) { return x.id !== id; });
            await saveData(); renderTabelKisah(); alert('Dihapus!');
        }
        
        // ========================================
        // GALERI
        // ========================================
        function renderTabelGaleri() {
            const tbody = document.getElementById('tabelGaleri');
            const list = allData.galeri;
            if (list.length === 0) { tbody.innerHTML = '<tr><td colspan="5" class="text-center text-muted">Belum ada data</td></tr>'; return; }
            tbody.innerHTML = list.map(function(item, index) {
                let preview = '';
                if (item.tipe === 'foto') { preview = '<img src="' + item.url + '" class="thumb-img">'; }
                else if (item.tipe === 'youtube') { preview = '<img src="https://img.youtube.com/vi/' + extractYoutubeId(item.url) + '/default.jpg" class="thumb-img">'; }
                else if (item.tipe === 'instagram') { preview = '<i class="fab fa-instagram fa-2x" style="color:#C13584"></i>'; }
                else if (item.tipe === 'tiktok') { preview = '<i class="fab fa-tiktok fa-2x"></i>'; }
                return '<tr><td>' + (index + 1) + '</td><td><span class="badge ' + getBadgeClass(item.tipe) + '">' + item.tipe.toUpperCase() + '</span></td><td>' + preview + '</td><td>' + item.judul + '</td><td>' +
                    '<button class="btn btn-warning btn-sm me-1" onclick="editGaleri(' + item.id + ')"><i class="fas fa-edit"></i></button>' +
                    '<button class="btn btn-danger btn-sm" onclick="hapusGaleri(' + item.id + ')"><i class="fas fa-trash"></i></button></td></tr>';
            }).join('');
        }
        
        function showModalGaleri() {
            document.getElementById('galeriId').value = '';
            document.getElementById('galeriTipe').value = 'foto';
            document.getElementById('galeriJudul').value = '';
            document.getElementById('galeriUrlFoto').value = '';
            document.getElementById('galeriUrlYoutube').value = '';
            document.getElementById('galeriUrlInstagram').value = '';
            document.getElementById('galeriUrlTiktok').value = '';
            document.getElementById('previewGaleri').classList.add('d-none');
            onGaleriTipeChange();
            new bootstrap.Modal(document.getElementById('modalGaleri')).show();
        }
        
        function onGaleriTipeChange() {
            const tipe = document.getElementById('galeriTipe').value;
            document.getElementById('wrapperUrlFoto').classList.add('d-none');
            document.getElementById('wrapperUrlYoutube').classList.add('d-none');
            document.getElementById('wrapperUrlInstagram').classList.add('d-none');
            document.getElementById('wrapperUrlTiktok').classList.add('d-none');
            document.getElementById('previewGaleri').classList.add('d-none');
            if (tipe === 'foto') { document.getElementById('wrapperUrlFoto').classList.remove('d-none'); }
            else if (tipe === 'youtube') { document.getElementById('wrapperUrlYoutube').classList.remove('d-none'); }
            else if (tipe === 'instagram') { document.getElementById('wrapperUrlInstagram').classList.remove('d-none'); }
            else if (tipe === 'tiktok') { document.getElementById('wrapperUrlTiktok').classList.remove('d-none'); }
        }
        
        function editGaleri(id) {
            let item = null;
            for (let i = 0; i < allData.galeri.length; i++) { if (allData.galeri[i].id === id) { item = allData.galeri[i]; break; } }
            if (!item) return;
            document.getElementById('galeriId').value = item.id;
            document.getElementById('galeriTipe').value = item.tipe;
            document.getElementById('galeriJudul').value = item.judul;
            document.getElementById('galeriUrlFoto').value = '';
            document.getElementById('galeriUrlYoutube').value = '';
            document.getElementById('galeriUrlInstagram').value = '';
            document.getElementById('galeriUrlTiktok').value = '';
            if (item.tipe === 'foto') { document.getElementById('galeriUrlFoto').value = item.url; document.getElementById('previewGaleri').src = item.url; document.getElementById('previewGaleri').classList.remove('d-none'); }
            else if (item.tipe === 'youtube') { document.getElementById('galeriUrlYoutube').value = item.url; }
            else if (item.tipe === 'instagram') { document.getElementById('galeriUrlInstagram').value = item.url; }
            else if (item.tipe === 'tiktok') { document.getElementById('galeriUrlTiktok').value = item.url; }
            onGaleriTipeChange();
            new bootstrap.Modal(document.getElementById('modalGaleri')).show();
        }
        
        async function simpanGaleri() {
            const id = document.getElementById('galeriId').value;
            const tipe = document.getElementById('galeriTipe').value;
            const judul = document.getElementById('galeriJudul').value.trim();
            let url = '';
            if (tipe === 'foto') { url = document.getElementById('galeriUrlFoto').value.trim(); }
            else if (tipe === 'youtube') { url = document.getElementById('galeriUrlYoutube').value.trim(); }
            else if (tipe === 'instagram') { url = document.getElementById('galeriUrlInstagram').value.trim(); }
            else if (tipe === 'tiktok') { url = document.getElementById('galeriUrlTiktok').value.trim(); }
            if (!judul) { alert('Judul harus diisi!'); return; }
            if (!url) { alert('URL harus diisi!'); return; }
            const newItem = { id: id ? parseInt(id) : Date.now(), tipe: tipe, judul: judul, url: url };
            if (id) { for (let i = 0; i < allData.galeri.length; i++) { if (allData.galeri[i].id === parseInt(id)) { allData.galeri[i] = newItem; break; } } }
            else { allData.galeri.push(newItem); }
            const success = await saveData();
            if (success) { bootstrap.Modal.getInstance(document.getElementById('modalGaleri')).hide(); renderTabelGaleri(); alert('Berhasil!'); }
        }
        
        async function hapusGaleri(id) {
            if (!confirm('Yakin hapus?')) return;
            allData.galeri = allData.galeri.filter(function(x) { return x.id !== id; });
            await saveData(); renderTabelGaleri(); alert('Dihapus!');
        }
        
        // ========================================
        // SERBA SERBI
        // ========================================
        function renderTabelSerbasabi() {
            const tbody = document.getElementById('tabelSerbasabi');
            const list = allData.serbasabi;
            if (list.length === 0) { tbody.innerHTML = '<tr><td colspan="4" class="text-center text-muted">Belum ada data</td></tr>'; return; }
            tbody.innerHTML = list.map(function(item, index) {
                return '<tr><td>' + (index + 1) + '</td><td><img src="' + item.gambar + '" class="thumb-img"></td><td>' + item.judul + '</td><td>' +
                    '<button class="btn btn-warning btn-sm me-1" onclick="editSerbasabi(' + item.id + ')"><i class="fas fa-edit"></i></button>' +
                    '<button class="btn btn-danger btn-sm" onclick="hapusSerbasabi(' + item.id + ')"><i class="fas fa-trash"></i></button></td></tr>';
            }).join('');
        }
        
        function showModalSerbasabi() {
            document.getElementById('serbasabiId').value = '';
            document.getElementById('serbasabiJudul').value = '';
            document.getElementById('serbasabiGambar').value = '';
            document.getElementById('serbasabiIsi').value = '';
            document.getElementById('previewSerbasabi').classList.add('d-none');
            new bootstrap.Modal(document.getElementById('modalSerbasabi')).show();
        }
        
        function editSerbasabi(id) {
            let item = null;
            for (let i = 0; i < allData.serbasabi.length; i++) { if (allData.serbasabi[i].id === id) { item = allData.serbasabi[i]; break; } }
            if (!item) return;
            document.getElementById('serbasabiId').value = item.id;
            document.getElementById('serbasabiJudul').value = item.judul;
            document.getElementById('serbasabiGambar').value = item.gambar;
            document.getElementById('serbasabiIsi').value = item.isi;
            document.getElementById('previewSerbasabi').src = item.gambar;
            document.getElementById('previewSerbasabi').classList.remove('d-none');
            new bootstrap.Modal(document.getElementById('modalSerbasabi')).show();
        }
        
        async function simpanSerbasabi() {
            const id = document.getElementById('serbasabiId').value;
            const judul = document.getElementById('serbasabiJudul').value.trim();
            const gambar = document.getElementById('serbasabiGambar').value.trim();
            const isi = document.getElementById('serbasabiIsi').value.trim();
            if (!judul || !gambar || !isi) { alert('Semua field harus diisi!'); return; }
            const newItem = { id: id ? parseInt(id) : Date.now(), judul: judul, gambar: gambar, isi: isi };
            if (id) { for (let i = 0; i < allData.serbasabi.length; i++) { if (allData.serbasabi[i].id === parseInt(id)) { allData.serbasabi[i] = newItem; break; } } }
            else { allData.serbasabi.push(newItem); }
            const success = await saveData();
            if (success) { bootstrap.Modal.getInstance(document.getElementById('modalSerbasabi')).hide(); renderTabelSerbasabi(); alert('Berhasil!'); }
        }
        
        async function hapusSerbasabi(id) {
            if (!confirm('Yakin hapus?')) return;
            allData.serbasabi = allData.serbasabi.filter(function(x) { return x.id !== id; });
            await saveData(); renderTabelSerbasabi(); alert('Dihapus!');
        }
        
        // ========================================
        // KEUANGAN
        // ========================================
        function renderTabelKeuangan() {
            const tbody = document.getElementById('tabelKeuangan');
            const keuangan = allData.keuangan;
            document.getElementById('saldoAwalKeuangan').value = keuangan.saldoAwal;
            let totalMasuk = 0, totalKeluar = 0;
            keuangan.transaksi.forEach(function(t) { if (t.jenis === 'masuk') { totalMasuk += t.jumlah; } else { totalKeluar += t.jumlah; } });
            document.getElementById('saldoKeuanganAdmin').textContent = formatRupiah(keuangan.saldoAwal + totalMasuk - totalKeluar);
            if (keuangan.transaksi.length === 0) { tbody.innerHTML = '<tr><td colspan="6" class="text-center text-muted">Belum ada transaksi</td></tr>'; return; }
            const sorted = keuangan.transaksi.slice().sort(function(a, b) { return new Date(b.tanggal) - new Date(a.tanggal); });
            tbody.innerHTML = sorted.map(function(item, index) {
                const badgeClass = (item.jenis === 'masuk') ? 'bg-success' : 'bg-danger';
                return '<tr><td>' + (index + 1) + '</td><td>' + item.tanggal + '</td><td>' + item.keterangan + '</td><td><span class="badge ' + badgeClass + '">' + item.jenis + '</span></td><td>' + formatRupiah(item.jumlah) + '</td><td>' +
                    '<button class="btn btn-danger btn-sm" onclick="hapusKeuangan(' + index + ')"><i class="fas fa-trash"></i></button></td></tr>';
            }).join('');
        }
        
        async function simpanSaldoAwalKeuangan() {
            allData.keuangan.saldoAwal = parseInt(document.getElementById('saldoAwalKeuangan').value) ? parseInt(document.getElementById('saldoAwalKeuangan').value) : 0;
            await saveData(); renderTabelKeuangan(); alert('Saldo awal disimpan!');
        }
        
        function showModalKeuangan() {
            document.getElementById('keuanganTanggal').value = new Date().toISOString().split('T')[0];
            document.getElementById('keuanganKeterangan').value = '';
            document.getElementById('keuanganJenis').value = 'masuk';
            document.getElementById('keuanganJumlah').value = '';
            new bootstrap.Modal(document.getElementById('modalKeuangan')).show();
        }
        
        async function simpanKeuangan() {
            const tanggal = document.getElementById('keuanganTanggal').value;
            const keterangan = document.getElementById('keuanganKeterangan').value.trim();
            const jenis = document.getElementById('keuanganJenis').value;
            const jumlah = parseInt(document.getElementById('keuanganJumlah').value);
            if (!tanggal || !keterangan || !jumlah) { alert('Semua field harus diisi!'); return; }
            allData.keuangan.transaksi.push({ tanggal: tanggal, keterangan: keterangan, jenis: jenis, jumlah: jumlah });
            const success = await saveData();
            if (success) { bootstrap.Modal.getInstance(document.getElementById('modalKeuangan')).hide(); renderTabelKeuangan(); alert('Berhasil!'); }
        }
        
        async function hapusKeuangan(index) {
            if (!confirm('Yakin hapus?')) return;
            const sorted = allData.keuangan.transaksi.slice().sort(function(a, b) { return new Date(b.tanggal) - new Date(a.tanggal); });
            const item = sorted[index];
            const origIndex = allData.keuangan.transaksi.indexOf(item);
            if (origIndex > -1) { allData.keuangan.transaksi.splice(origIndex, 1); }
            await saveData(); renderTabelKeuangan(); alert('Dihapus!');
        }
        
        // ========================================
        // ZAKAT
        // ========================================
        function renderTabelZakat() {
            const tbody = document.getElementById('tabelZakat');
            const zakat = allData.zakat;
            document.getElementById('saldoAwalZakat').value = zakat.saldoAwal;
            let totalMasuk = 0, totalKeluar = 0;
            zakat.transaksi.forEach(function(t) { if (t.jenis === 'masuk') { totalMasuk += t.jumlah; } else { totalKeluar += t.jumlah; } });
            document.getElementById('saldoZakatAdmin').textContent = formatRupiah(zakat.saldoAwal + totalMasuk - totalKeluar);
            if (zakat.transaksi.length === 0) { tbody.innerHTML = '<tr><td colspan="6" class="text-center text-muted">Belum ada transaksi</td></tr>'; return; }
            const sorted = zakat.transaksi.slice().sort(function(a, b) { return new Date(b.tanggal) - new Date(a.tanggal); });
            tbody.innerHTML = sorted.map(function(item, index) {
                const badgeClass = (item.jenis === 'masuk') ? 'bg-success' : 'bg-info';
                const label = (item.jenis === 'masuk') ? 'Masuk' : 'Disalurkan';
                return '<tr><td>' + (index + 1) + '</td><td>' + item.tanggal + '</td><td>' + item.keterangan + '</td><td><span class="badge ' + badgeClass + '">' + label + '</span></td><td>' + formatRupiah(item.jumlah) + '</td><td>' +
                    '<button class="btn btn-danger btn-sm" onclick="hapusZakat(' + index + ')"><i class="fas fa-trash"></i></button></td></tr>';
            }).join('');
        }
        
        async function simpanSaldoAwalZakat() {
            allData.zakat.saldoAwal = parseInt(document.getElementById('saldoAwalZakat').value) ? parseInt(document.getElementById('saldoAwalZakat').value) : 0;
            await saveData(); renderTabelZakat(); alert('Saldo awal disimpan!');
        }
        
        function showModalZakat() {
            document.getElementById('zakatTanggal').value = new Date().toISOString().split('T')[0];
            document.getElementById('zakatKeterangan').value = '';
            document.getElementById('zakatJenis').value = 'masuk';
            document.getElementById('zakatJumlah').value = '';
            new bootstrap.Modal(document.getElementById('modalZakat')).show();
        }
        
        async function simpanZakat() {
            const tanggal = document.getElementById('zakatTanggal').value;
            const keterangan = document.getElementById('zakatKeterangan').value.trim();
            const jenis = document.getElementById('zakatJenis').value;
            const jumlah = parseInt(document.getElementById('zakatJumlah').value);
            if (!tanggal || !keterangan || !jumlah) { alert('Semua field harus diisi!'); return; }
            allData.zakat.transaksi.push({ tanggal: tanggal, keterangan: keterangan, jenis: jenis, jumlah: jumlah });
            const success = await saveData();
            if (success) { bootstrap.Modal.getInstance(document.getElementById('modalZakat')).hide(); renderTabelZakat(); alert('Berhasil!'); }
        }
        
        async function hapusZakat(index) {
            if (!confirm('Yakin hapus?')) return;
            const sorted = allData.zakat.transaksi.slice().sort(function(a, b) { return new Date(b.tanggal) - new Date(a.tanggal); });
            const item = sorted[index];
            const origIndex = allData.zakat.transaksi.indexOf(item);
            if (origIndex > -1) { allData.zakat.transaksi.splice(origIndex, 1); }
            await saveData(); renderTabelZakat(); alert('Dihapus!');
        }
        
        // ========================================
        // REKENING
        // ========================================
        function renderTabelRekening() {
            const tbody = document.getElementById('tabelRekening');
            const list = allData.rekening;
            if (list.length === 0) { tbody.innerHTML = '<tr><td colspan="5" class="text-center text-muted">Belum ada data</td></tr>'; return; }
            tbody.innerHTML = list.map(function(item, index) {
                return '<tr><td>' + (index + 1) + '</td><td>' + item.bank + '</td><td>' + item.norek + '</td><td>' + item.atasnama + '</td><td>' +
                    '<button class="btn btn-warning btn-sm me-1" onclick="editRekening(' + item.id + ')"><i class="fas fa-edit"></i></button>' +
                    '<button class="btn btn-danger btn-sm" onclick="hapusRekening(' + item.id + ')"><i class="fas fa-trash"></i></button></td></tr>';
            }).join('');
        }
        
        function showModalRekening() {
            document.getElementById('rekeningId').value = '';
            document.getElementById('rekeningBank').value = '';
            document.getElementById('rekeningNorek').value = '';
            document.getElementById('rekeningAtasnama').value = '';
            new bootstrap.Modal(document.getElementById('modalRekening')).show();
        }
        
        function editRekening(id) {
            let item = null;
            for (let i = 0; i < allData.rekening.length; i++) { if (allData.rekening[i].id === id) { item = allData.rekening[i]; break; } }
            if (!item) return;
            document.getElementById('rekeningId').value = item.id;
            document.getElementById('rekeningBank').value = item.bank;
            document.getElementById('rekeningNorek').value = item.norek;
            document.getElementById('rekeningAtasnama').value = item.atasnama;
            new bootstrap.Modal(document.getElementById('modalRekening')).show();
        }
        
        async function simpanRekening() {
            const id = document.getElementById('rekeningId').value;
            const bank = document.getElementById('rekeningBank').value.trim();
            const norek = document.getElementById('rekeningNorek').value.trim();
            const atasnama = document.getElementById('rekeningAtasnama').value.trim();
            if (!bank || !norek || !atasnama) { alert('Semua field harus diisi!'); return; }
            const newItem = { id: id ? parseInt(id) : Date.now(), bank: bank, norek: norek, atasnama: atasnama };
            if (id) { for (let i = 0; i < allData.rekening.length; i++) { if (allData.rekening[i].id === parseInt(id)) { allData.rekening[i] = newItem; break; } } }
            else { allData.rekening.push(newItem); }
            const success = await saveData();
            if (success) { bootstrap.Modal.getInstance(document.getElementById('modalRekening')).hide(); renderTabelRekening(); alert('Berhasil!'); }
        }
        
        async function hapusRekening(id) {
            if (!confirm('Yakin hapus?')) return;
            allData.rekening = allData.rekening.filter(function(x) { return x.id !== id; });
            await saveData(); renderTabelRekening(); alert('Dihapus!');
        }
    </script>
</body>
</html>
    
  </body>
  
</html>
